<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
	<title>cosmoz-omnitable list test</title>

	<script src="../../@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>
	<script src="../../wct-browser-legacy/browser.js"></script>
	<script src="../../@polymer/test-fixture/test-fixture-mocha.js"></script>
	<script src="./helpers/utils.js"></script>

	<script type="module" src="../../@polymer/test-fixture/test-fixture.js"></script>
	<script type="module" src="../../@polymer/iron-test-helpers/iron-test-helpers.js"></script>
	<script type="module" src="../cosmoz-omnitable.js"></script>
	<script type="module" src="../cosmoz-omnitable-columns.js"></script>
	<script type="module" src="../demo/table-demo-helper.js"></script>
</head>
<body>
	<test-fixture id="basic">
		<template>
			<cosmoz-omnitable id="omnitable" class="flex" selection-enabled>
				<cosmoz-omnitable-column-list name="list" value-path="list">
				</cosmoz-omnitable-column-list>
			</cosmoz-omnitable>
		</template>
	</test-fixture>
	<test-fixture id="horizontal">
		<template>
			<cosmoz-omnitable id="omnitable" class="flex" selection-enabled>
				<cosmoz-omnitable-column-list-horizontal name="list" value-path="list">
				</cosmoz-omnitable-column-list-horizontal>
			</cosmoz-omnitable>
		</template>
	</test-fixture>

	<script type="module">
import '../../@polymer/test-fixture/test-fixture.js';
import '../../@polymer/iron-test-helpers/iron-test-helpers.js';
import '../cosmoz-omnitable.js';
import '../cosmoz-omnitable-columns.js';
import '../demo/table-demo-helper.js';

suite('basic', () => {
	let omnitable,
		column,
		data;

	setup(done => {
		data = [
			{ list: ['item 1', 'item 2', 'item 3'] },
		];
		omnitable = setupOmnitableFixture('basic', data, o => {
			column = o.columns[0];
			done();
		});
	});

	test('initializes list column', () => {
		assert.instanceOf(column, Cosmoz.OmnitableColumnList);
	});

	test('_getDefaultFilter returns []', () => {
		assert.isTrue(Array.isArray(column.filter));
		assert.equal(column.filter.length, 0);
		assert.isTrue(Array.isArray(column._getDefaultFilter()));
		assert.equal(column._getDefaultFilter().length, 0);
	});

	test('_applySingleFilter returns true if filterString is equal to value', () => {
		assert.isTrue(column._applySingleFilter('abc', {list: 'abc', some: 'data'}));
	});
	test('_applySingleFilter returns false if filterString is not equal to value', () => {
		assert.isFalse(column._applySingleFilter('abc', {list: 'def', some: 'data'}));
	});

	test('_applySingleFilters handles null', () => {
		assert.isFalse(column._applySingleFilter('abc'));
		assert.isFalse(column._applySingleFilter());
	});

	test('_applyMultiFilter works', () => {
		assert.isTrue(column._applyMultiFilter([123, 456], { list: [123, 345, 678]}));
	});
});
suite('horizontal', () => {
	let omnitable,
		column,
		data;

	setup(done => {
		data = [
			{ list: ['item 1', 'item 2', 'item 3'] },
		];
		omnitable = setupOmnitableFixture('horizontal', data, o => {
			column = o.columns[0];
			done();
		});
	});

	test('initializes list column', () => {
		assert.instanceOf(column, Cosmoz.OmnitableColumnListHorizontal);
	});

	test('_getDefaultFilter returns []', () => {
		assert.isTrue(Array.isArray(column.filter));
		assert.equal(column.filter.length, 0);
		assert.isTrue(Array.isArray(column._getDefaultFilter()));
		assert.equal(column._getDefaultFilter().length, 0);
	});

	test('_applySingleFilter returns true if filterString is equal to value', () => {
		assert.isTrue(column._applySingleFilter('abc', {list: 'abc', some: 'data'}));
	});
	test('_applySingleFilter returns false if filterString is not equal to value', () => {
		assert.isFalse(column._applySingleFilter('abc', {list: 'def', some: 'data'}));
	});

	test('_applySingleFilters handles null', () => {
		assert.isFalse(column._applySingleFilter('abc'));
		assert.isFalse(column._applySingleFilter());
	});

	test('_applyMultiFilter works', () => {
		assert.isTrue(column._applyMultiFilter([123, 456], { list: ['123', '345', '678']}));
	});

	test('getString returns values', () => {
		column.textProperty = null;
		assert.equal(column.getString({ list: ['123', '345', '678']}), '123, 345, 678');
	});
});
</script>
</html>
